<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Email Campaign Analytics Report - G-Realm Studio</title>
  </head>
  <body
    style="
      margin: 0;
      padding: 0;
      background: #f8f8f8;
      width: 100%;
      font-family: Arial, Helvetica, sans-serif;
      color: #222;
    ">
    <center style="width: 100%; background: #f8f8f8">
      <table
        role="presentation"
        width="100%"
        cellpadding="0"
        cellspacing="0"
        border="0"
        style="background: #f8f8f8">
        <tr>
          <td align="center">
            <table
              role="presentation"
              width="600"
              cellpadding="0"
              cellspacing="0"
              border="0"
              style="
                max-width: 600px;
                width: 100%;
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
                margin: 24px 0;
              ">
              <tr>
                <td
                  style="
                    background: #00b33c;
                    color: #fff;
                    text-align: center;
                    padding: 24px 20px 12px 20px;
                    border-top-left-radius: 12px;
                    border-top-right-radius: 12px;
                  ">
                  <h1
                    style="
                      margin: 0;
                      font-size: 24px;
                      font-family: 'Playfair Display', Georgia, serif;
                      color: #fff;
                    ">
                    Email Campaign Analytics
                  </h1>
                  <p style="margin: 6px 0 0 0; font-size: 14px; color: #ecff1a">
                    G-Realm Studio Report
                  </p>
                </td>
              </tr>
              <tr>
                <td style="padding: 28px 24px 0 24px">
                  <table
                    width="100%"
                    cellpadding="0"
                    cellspacing="0"
                    border="0">
                    <tr>
                      <td
                        colspan="3"
                        style="
                          font-size: 18px;
                          font-weight: bold;
                          color: #0056b3;
                          border-bottom: 1px solid #eeeeee;
                          padding-bottom: 10px;
                        ">
                        Campaign Summary
                      </td>
                    </tr>
                    <tr>
                      <td
                        align="center"
                        style="
                          padding: 18px 8px;
                          border-right: 1px solid #f0f0f0;
                        ">
                        <div
                          style="
                            font-size: 28px;
                            font-weight: bold;
                            color: #007bff;
                          ">
                          <%= totalEmails %>
                        </div>
                        <div
                          style="
                            font-size: 13px;
                            color: #666;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                          ">
                          Total Attempted
                        </div>
                      </td>
                      <td
                        align="center"
                        style="
                          padding: 18px 8px;
                          border-right: 1px solid #f0f0f0;
                        ">
                        <div
                          style="
                            font-size: 28px;
                            font-weight: bold;
                            color: #28a745;
                          ">
                          <%= successfulEmails %>
                        </div>
                        <div
                          style="
                            font-size: 13px;
                            color: #666;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                          ">
                          Successfully Sent
                        </div>
                      </td>
                      <td align="center" style="padding: 18px 8px">
                        <div
                          style="
                            font-size: 28px;
                            font-weight: bold;
                            color: #dc3545;
                          ">
                          <%= failedEmails %>
                        </div>
                        <div
                          style="
                            font-size: 13px;
                            color: #666;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                          ">
                          Failed to Send
                        </div>
                      </td>
                    </tr>
                  </table>
                  <table
                    width="100%"
                    cellpadding="0"
                    cellspacing="0"
                    border="0"
                    style="margin-top: 24px">
                    <tr>
                      <td
                        colspan="2"
                        style="
                          font-size: 18px;
                          font-weight: bold;
                          color: #0056b3;
                          border-bottom: 1px solid #eeeeee;
                          padding-bottom: 10px;
                        ">
                        Campaign Details
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 10px 0; font-size: 15px">
                        <strong style="color: #555">Subject:</strong>
                      </td>
                      <td style="padding: 10px 0; font-size: 15px">
                        <%= subject %>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 10px 0; font-size: 15px">
                        <strong style="color: #555">Email Type:</strong>
                      </td>
                      <td style="padding: 10px 0; font-size: 15px">
                        <%= emailType %>
                      </td>
                    </tr>
                  </table>
                  <table
                    width="100%"
                    cellpadding="0"
                    cellspacing="0"
                    border="0"
                    style="margin-top: 24px">
                    <tr>
                      <td
                        colspan="3"
                        style="
                          font-size: 18px;
                          font-weight: bold;
                          color: #0056b3;
                          border-bottom: 1px solid #eeeeee;
                          padding-bottom: 10px;
                        ">
                        Successfully Sent To
                      </td>
                    </tr>
                    <tr>
                      <th
                        align="left"
                        style="
                          border-bottom: 1px solid #eeeeee;
                          padding: 8px;
                          font-size: 14px;
                        ">
                        #
                      </th>
                      <th
                        align="left"
                        style="
                          border-bottom: 1px solid #eeeeee;
                          padding: 8px;
                          font-size: 14px;
                        ">
                        School Name
                      </th>
                      <th
                        align="left"
                        style="
                          border-bottom: 1px solid #eeeeee;
                          padding: 8px;
                          font-size: 14px;
                        ">
                        Email
                      </th>
                    </tr>
                    <% successfulRecipients.forEach((recipient, index) => { %>
                    <tr>
                      <td
                        style="
                          border-bottom: 1px solid #eeeeee;
                          padding: 8px;
                          font-size: 14px;
                        ">
                        <%= index + 1 %>
                      </td>
                      <td
                        style="
                          border-bottom: 1px solid #eeeeee;
                          padding: 8px;
                          font-size: 14px;
                        ">
                        <%= recipient.schoolname %>
                      </td>
                      <td
                        style="
                          border-bottom: 1px solid #eeeeee;
                          padding: 8px;
                          font-size: 14px;
                        ">
                        <%= recipient.email %>
                      </td>
                    </tr>
                    <% }); %>
                  </table>
                  <div style="margin: 24px 0 0 0; text-align: center">
                    <a
                      href="/download-csv"
                      style="
                        display: inline-block;
                        padding: 10px 20px;
                        background-color: #007bff;
                        color: #fff;
                        text-decoration: none;
                        border-radius: 5px;
                        font-weight: bold;
                        font-size: 15px;
                      "
                      >Download CSV</a
                    >
                  </div>
                  <table
                    width="100%"
                    cellpadding="0"
                    cellspacing="0"
                    border="0"
                    style="margin-top: 24px">
                    <tr>
                      <td
                        style="
                          font-size: 18px;
                          font-weight: bold;
                          color: #0056b3;
                          border-bottom: 1px solid #eeeeee;
                          padding-bottom: 10px;
                        ">
                        Original Email Content
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 16px 0 0 0">
                        <% if (emailType === 'html') { %>
                        <div
                          style="
                            background: #fff;
                            padding: 15px;
                            border-radius: 4px;
                            border: 1px solid #e0e0e0;
                            font-size: 14px;
                            line-height: 1.5;
                            overflow-x: auto;
                          ">
                          <%- originalMessage %>
                        </div>
                        <% } else { %>
                        <pre
                          style="
                            background: #f0f0f0;
                            border-radius: 4px;
                            border: 1px solid #e0e0e0;
                            padding: 15px;
                            font-size: 14px;
                            line-height: 1.5;
                            margin: 0;
                            overflow-x: auto;
                          ">
<%= originalMessage %></pre
                        >
                        <% } %>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td
                  style="
                    background: #eeeeee;
                    padding: 20px 30px;
                    text-align: center;
                    font-size: 12px;
                    color: #777;
                    border-bottom-left-radius: 12px;
                    border-bottom-right-radius: 12px;
                  ">
                  &copy; <%= new Date().getFullYear() %> G-Realm Studio. All
                  rights reserved.<br />
                  Report generated by G-Realm Studio Email Sender.
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </center>
  </body>
</html>
